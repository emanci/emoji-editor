{"version":3,"sources":["OwO.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","OwO","option","_this","this","defaultOption","logo","container","document","getElementsByClassName","getElementsByTagName","position","width","maxHeight","api","defaultKey","hasOwnProperty","classList","add","xhr","XMLHttpRequest","onreadystatechange","readyState","status","odata","JSON","parse","responseText","init","console","log","open","send","value","_this2","area","packages","keys","html","type","parseInt","opackage","text","icon","innerHTML","addEventListener","toggle","e","contains","parentNode","cursorPos","selectionEnd","areaValue","slice","focus","packagesEle","_loop","index","children","tab","remove","itemsShow","packageActive","module","exports","window"],"mappings":"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","file":"OwO.min.js","sourcesContent":["(() => {\n    class OwO {\n        constructor(option) {\n            const defaultOption = {\n                logo: '表情',\n                container: document.getElementsByClassName('OwO')[0],\n                target: document.getElementsByTagName('textarea')[0],\n                position: 'down',\n                width: '500px',\n                maxHeight: '300px',\n                api: 'http://localhost/study/OwO/demo/OwO.json'\n                //api: 'http://laravel.name/wxTest/OwO/demo/OwO.json'\n            };\n            for (let defaultKey in defaultOption) {\n                if (defaultOption.hasOwnProperty(defaultKey) && !option.hasOwnProperty(defaultKey)) {\n                    option[defaultKey] = defaultOption[defaultKey];\n                }\n            }\n            this.container = option.container;\n            this.target = option.target;\n            if (option.position === 'up') {\n                this.container.classList.add('OwO-up');\n            }\n\n            const xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = () => {\n                if (xhr.readyState === 4) {\n                    if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {\n                        this.odata = JSON.parse(xhr.responseText);\n                        this.init(option);\n                    } else {\n                        console.log('OwO data request was unsuccessful: ' + xhr.status);\n                    }\n                }\n            };\n            xhr.open('get', option.api, true);\n            xhr.send(null);\n        }\n\n        init(option) {\n            this.area = option.target;\n            this.packages = Object.keys(this.odata);\n\n            // fill in HTML\n            let html = `\n            <div class=\"OwO-logo\"><span>${option.logo}</span></div>\n            <div class=\"OwO-body\" style=\"width: ${option.width}\">`;\n\n            for (let i = 0; i < this.packages.length; i++) {\n\n                html += `\n                <ul class=\"OwO-items OwO-items-${this.odata[this.packages[i]].type}\" style=\"max-height: ${parseInt(option.maxHeight) - 53 + 'px'};\">`;\n\n                let opackage = this.odata[this.packages[i]].container;\n                for (let i = 0; i < opackage.length; i++) {\n\n                    html += `\n                    <li class=\"OwO-item\" title=\"${opackage[i].text}\">${opackage[i].icon}</li>`;\n\n                }\n\n                html += `\n                </ul>`;\n            }\n\n            html += `\n                <div class=\"OwO-bar\">\n                    <ul class=\"OwO-packages\">`;\n            for (let i = 0; i < this.packages.length; i++) {\n                html += `\n                            <li><span>${this.packages[i]}</span></li>`\n            }\n            html += `\n                    </ul>\n                </div>\n            </div>\n            `;\n            this.container.innerHTML = html;\n\n            // bind event\n            this.logo = this.container.getElementsByClassName('OwO-logo')[0];\n            this.logo.addEventListener('click', () => {\n                this.toggle();\n            });\n\n            this.container.getElementsByClassName('OwO-body')[0].addEventListener('click', (e) => {\n                let target = null;\n                if (e.target.classList.contains('OwO-item')) {\n                    target = e.target;\n                } else if (e.target.parentNode.classList.contains('OwO-item')) {\n                    target = e.target.parentNode;\n                }\n                if (target) {\n                    const cursorPos = this.area.selectionEnd;\n                    let areaValue = this.area.value;\n                    this.area.value = areaValue.slice(0, cursorPos) + target.innerHTML + areaValue.slice(cursorPos);\n                    this.area.focus();\n                    this.toggle();\n                }\n            });\n\n            this.packagesEle = this.container.getElementsByClassName('OwO-packages')[0];\n            for (let i = 0; i < this.packagesEle.children.length; i++) {\n                ((index) => {\n                    this.packagesEle.children[i].addEventListener('click', () => {\n                        this.tab(index);\n                    });\n                })(i);\n            }\n\n            this.tab(0);\n        }\n\n        toggle() {\n            if (this.container.classList.contains('OwO-open')) {\n                this.container.classList.remove('OwO-open');\n            } else {\n                this.container.classList.add('OwO-open');\n            }\n        }\n\n        tab(index) {\n            const itemsShow = this.container.getElementsByClassName('OwO-items-show')[0];\n            if (itemsShow) {\n                itemsShow.classList.remove('OwO-items-show');\n            }\n            this.container.getElementsByClassName('OwO-items')[index].classList.add('OwO-items-show');\n\n            const packageActive = this.container.getElementsByClassName('OwO-package-active')[0];\n            if (packageActive) {\n                packageActive.classList.remove('OwO-package-active');\n            }\n            this.packagesEle.getElementsByTagName('li')[index].classList.add('OwO-package-active');\n        }\n    }\n    if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n        module.exports = OwO;\n    } else {\n        window.OwO = OwO;\n    }\n})();\n"]}